# 地震後の地盤変位解析ツール

このPythonスクリプト（`postseismic_model_fitting.py`）は、地震後の地盤変位データを解析し、異なる数学モデルを用いて地震後の変形パターンをモデル化するために設計されています。

## 機能

- **データ処理**: CSVファイルから地盤変位データを読み込み、処理します
- **複数の変位モデル**:
  - 指数モデル: `A + B*t + C*exp(-t/tau)`
  - 対数モデル: `A + B*t + C*log10(1+t/tau)`
  - 拡張複合モデル: `A + B*t + C_exp*exp(-t/tau_exp) + C_log*log10(1+t/tau_log)`
- **パラメータ最適化**: `scipy.optimize.minimize`を使用して各モデルの最適パラメータを求めます
- **可視化**: データと3つのモデルを比較する詳細なプロットを作成します
- **結果のエクスポート**: 最適化されたモデルパラメータをCSVファイルに保存します

## 必要条件

- Python 3.x
- 必要なパッケージ: numpy, pandas, matplotlib, scipy

## 使用方法

1. 変位データをCSV形式で準備します。列は: Day, d-Lat, d-Lon, d-Hei
   - Day: 地震発生後の日数
   - d-Lat, d-Lon, d-Hei: 緯度、経度、高さの変位値

2. スクリプトを実行:
   ```
   python exe.py
   ```

3. スクリプトは以下の処理を行います:
   - データを3つのモデルに適合させる
   - 可視化プロットを生成（PNGファイルとして保存）
   - モデルパラメータをCSVファイルにエクスポート:
     - `exp_model_results.csv`
     - `log_model_results.csv`
     - `enhanced_model_results.csv`

## データ構造

このスクリプトは現在、2011年東北地震の鳴子観測所データを解析するように設定されていますが、スクリプト内のファイルパスを変更することで他のデータセットでも動作するように変更できます。

## 出力

- **モデルパラメータCSVファイル**: 各モデルの最適化された値が含まれます
- **可視化プロット**: 緯度、経度、高さの変位に関する3つのモデルを比較する9パネルのプロット